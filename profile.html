<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TRIBERIUM â€” Profile</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/profile.css">
  <link rel="manifest" href="pwa/manifest.json">
</head>
<body>

  <!-- ======================== -->
  <!-- HEADER / NAV -->
  <!-- ======================== -->
  <header class="flex container">
    <h1>TRIBERIUM</h1>
    <a href="home.html">Home</a>
  </header>

  <!-- ======================== -->
  <!-- PROFILE INFO -->
  <!-- ======================== -->
  <section class="container center" id="profileInfo">
    <div class="profile-picture">
      <img id="profileImg" src="https://via.placeholder.com/150" alt="Profile Picture">
      <input type="file" id="uploadProfileImg" accept="image/*">
      <button id="saveProfileImg">Update Picture</button>
    </div>
    <h2 id="profileUsername">Username</h2>
    <p id="profileEmail">Email: user@example.com</p>
  </section>

  <!-- ======================== -->
  <!-- FOLLOWERS / FOLLOWING -->
  <!-- ======================== -->
  <section class="container">
    <h3>Following</h3>
    <div class="follow-list" id="followingList">
      <!-- Users the current user follows -->
    </div>

    <h3>Followers</h3>
    <div class="follow-list" id="followersList">
      <!-- Users who follow the current user -->
    </div>
  </section>

  <!-- ======================== -->
  <!-- DIRECT MESSAGES (DM) -->
  <!-- ======================== -->
  <section class="container">
    <h3>Direct Messages</h3>
    <div class="dm-container" id="dmContainer">
      <!-- Messages will be injected here -->
    </div>
    <textarea id="dmInput" placeholder="Type a message..."></textarea>
    <button id="sendDmBtn">Send</button>
  </section>

  <!-- ======================== -->
  <!-- METRICS -->
  <!-- ======================== -->
  <section class="container">
    <h3>Profile Metrics</h3>
    <ul>
      <li>Posts: <span id="metricPosts">0</span></li>
      <li>Likes: <span id="metricLikes">0</span></li>
      <li>Comments: <span id="metricComments">0</span></li>
    </ul>
  </section>

  <!-- ======================== -->
  <!-- SCRIPTS -->
  <!-- ======================== -->
  <script type="module" src="js/firebase.js"></script>
  <script type="module" src="js/auth.js"></script>
  <script type="module" src="js/profile.js"></script>
  <script type="module" src="js/follow.js"></script>
  <script type="module" src="js/dm.js"></script>
  <script type="module" src="js/analytics.js"></script>
  <script type="module">
    import { loadProfile } from './js/profile.js';
    import { loadFollowers, loadFollowing } from './js/follow.js';
    import { loadProfileMetrics } from './js/analytics.js';

    document.addEventListener("DOMContentLoaded", async () => {
      await loadProfile('profileUsername', 'profileEmail', 'profileImg');
      await loadFollowers('followersList');
      await loadFollowing('followingList');
      await loadProfileMetrics();
    });
  </script>

</body>
</html>